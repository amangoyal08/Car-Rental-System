create database CAR_RENTAL;
USE CAR_RENTAL;

CREATE TABLE CUSTOMER(
DL_Number CHAR(10) NOT NULL,
Fname VARCHAR(25) NOT NULL,
Mname VARCHAR(25),
Lname VARCHAR(25) NOT NULL,
Age INT NOT NULL,
Sex CHAR NOT NULL,
Email VARCHAR(50) NOT NULL,
Phone_No CHAR(10) NOT NULL, 
Pin_Code BIGINT NOT NULL,
Street VARCHAR(50) NOT NULL,
City VARCHAR(20) NOT NULL,
State VARCHAR(20) NOT NULL,
CHECK (Age>=18),
PRIMARY KEY(DL_Number));

CREATE TABLE CAR_DETAILS(
Car_Type VARCHAR(25) NOT NULL,
P_Capacity INT NOT NULL,
L_Capacity INT NOT NULL,
Cost_Per_Day DECIMAL(5,2) NOT NULL,
Late_Fee_Per_Day DECIMAL(5,2) NOT NULL,
Fuel_Type VARCHAR(15) NOT NULL,
PRIMARY KEY(Car_Type));

CREATE TABLE LOCATION_DETAILS(
Location_ID CHAR(4) NOT NULL,
Location_Name VARCHAR(100) NOT NULL,
Pin_Code BIGINT NOT NULL, 
Street VARCHAR(25) NOT NULL, 
City VARCHAR(25) NOT NULL,
State VARCHAR(25) NOT NULL,
PRIMARY KEY (Location_ID));

CREATE TABLE RENTAL_CAR(
Registration_NO CHAR(10) NOT NULL,
Model_Name VARCHAR(50) NOT NULL,
Mileage DECIMAL(4,2) NOT NULL,
Model_Year INT NOT NULL,
Distance_Travelled INT NOT NULL,
Car_Category VARCHAR(25) NOT NULL,
L_ID CHAR(4) NOT NULL,
PRIMARY KEY (Registration_NO),
FOREIGN KEY (L_ID) REFERENCES LOCATION_DETAILS (Location_ID),
FOREIGN KEY (Car_Category) REFERENCES CAR_DETAILS (Car_Type));

CREATE TABLE CAR_INSURANCE(
Insurance_ID CHAR(4) NOT NULL,
Insurance_Type VARCHAR(100) NOT NULL,
Cost_per_day DECIMAL(5,2) NOT NULL,
PRIMARY KEY (Insurance_ID));



CREATE TABLE BOOKING_DETAILS(
Booking_ID CHAR(5) NOT NULL,
Date_From TIMESTAMP NOT NULL,
Date_Till TIMESTAMP NOT NULL,
Amount DECIMAL(10,2) NOT NULL,
Booking_status VARCHAR(10) NOT NULL,
Pick_up_Loc_id CHAR(4) NOT NULL,
Drop_off_Loc_id CHAR(4) NOT NULL,
Reg_NO CHAR(10) NOT NULL,
DL_Num CHAR(10) NOT NULL,
Ins_ID CHAR(4),
PRIMARY KEY (Booking_ID), 
FOREIGN KEY (Pick_up_Loc_id) REFERENCES LOCATION_DETAILS (Location_ID),
FOREIGN KEY (Drop_off_Loc_id) REFERENCES LOCATION_DETAILS (Location_ID),
FOREIGN KEY (Reg_NO) REFERENCES RENTAL_CAR (Registration_NO),
FOREIGN KEY (DL_Num) REFERENCES CUSTOMER (DL_Number),
FOREIGN KEY (Ins_ID) REFERENCES CAR_INSURANCE (Insurance_ID));

CREATE TABLE FINAL_BILL(
Bill_ID CHAR(6) NOT NULL,
Bill_Date DATE NOT NULL,
Bill_Status VARCHAR(10) NOT NULL,
Total_Amount Decimal(10,2) NOT NULL,
Tax_Amount DECIMAL(10,2) NOT NULL,
B_ID CHAR(5) NOT NULL,
Total_Late_Fee DECIMAL(10,2) NOT NULL,
PRIMARY KEY(Bill_ID),
FOREIGN KEY(B_ID) REFERENCES BOOKING_DETAILS(Booking_ID));

INSERT INTO CUSTOMER VALUES('DL20125990','SURESH',NULL,'KUMAR',32,'M','suresh@gmail.com','7842378508',110045,'GANDHI MARG','NEW DELHI','DELHI');
INSERT INTO CUSTOMER VALUES('HR20047468','SAHIL',NULL,'KUMAR',45,'M','sahil@gmail.com','9484653745',264647,'PRAGITI COLONY','FARIDABAD','HARYANA');
INSERT INTO CUSTOMER VALUES('MH20157494','RAKESH','S','JHA',27,'M','rakesh@gmail.com','8946755638',400015,'AMBEDKAR MARG','MUMBAI','MAHARASHTRA');
INSERT INTO CUSTOMER VALUES('DL20079891','NAVEEN',NULL,'RAJ',39,'M','naveen@gmail.com','9563839593',110088,'CANNAUGHT LANE','NEW DELHI','DELHI');
INSERT INTO CUSTOMER VALUES('UP20155780','NIVEDITA','R','SHARMA',26,'F','nivedita@gmail.com','9484657486',340485,'75 LANE','NOIDA','UTTAR PRADESH');
INSERT INTO CUSTOMER VALUES('MH20034758','AJAY',NULL,'GUPTA',56,'M','ajay@gmail.com','8647483937',467448,'NEHRU ROAD','NAGPUR','MAHARASHTRA');
INSERT INTO CUSTOMER VALUES('HR20135949','AMAN',NULL,'GUPTA',43,'M','aman@gmail.com','8575947390',255945,'VIKAS MARG','GURUGRAM','HARYANA');
INSERT INTO CUSTOMER VALUES('DL2016576','AKSHAY',NULL,'VERMA',23,'M','akshay@gmail.com','9384765884',110016,'NARAYAN CHOWK','NEW DELHI','DELHI');
INSERT INTO CUSTOMER VALUES('UP20024564','ANKIT',NULL,'SHARMA',35,'M','ankit@gmail.com','9474645845',365758,'KAMRAJ ROAD','KANPUR','UTTAR PRADESH');
INSERT INTO CUSTOMER VALUES('PB20123748','NEHA',NULL,'MALIK',26,'F','neha@gmail.com','8463574840',567585,'RAJIV CHOWK','LUDHIYANA','PUNJAB');



INSERT INTO CAR_DETAILS VALUES('ECONOMY',5,2,30,0.9,'PETROL');
INSERT INTO CAR_DETAILS VALUES('COMPACT',5,3,32,0.96,'PETROL');
INSERT INTO CAR_DETAILS VALUES('MID SIZE',5,3,35,1.05,'DIESEL');
INSERT INTO CAR_DETAILS VALUES('STANDARD',5,3,38,1.14,'CNG');
INSERT INTO CAR_DETAILS VALUES('FULL SIZE',5,4,40,1.2,'PETROL');
INSERT INTO CAR_DETAILS VALUES('LUXURY CAR',5,5,75,2.25,'CNG');
INSERT INTO CAR_DETAILS VALUES('MID SIZE SUV',5,2,36,1.08,'PETROL');
INSERT INTO CAR_DETAILS VALUES('STANDARD SUV',5,3,40,1.2,'CNG');
INSERT INTO CAR_DETAILS VALUES('FULL SIZE SUV',8,2,60,1.8,'DIESEL');
INSERT INTO CAR_DETAILS VALUES('MINI VAN',7,5,70,2.1,'PETROL');



INSERT INTO LOCATION_DETAILS VALUES('L101','PALLAM AIRPORT',110346,'GT ROAD','NEW DELHI','DELHI');
INSERT INTO LOCATION_DETAILS VALUES('L102','NEW DELHI RAILWAY STATION',193745,'SKY LANE','NEW DELHI','DELHI');
INSERT INTO LOCATION_DETAILS VALUES('L103','IGI AIRPORT',746484,'KARNAL ROAD','NEW DELHI','DELHI');
INSERT INTO LOCATION_DETAILS VALUES('L104','SHIVAJI AIRPORT',576855,'LINKING ROAD','MUMBAI','MAHARASHTRA');
INSERT INTO LOCATION_DETAILS VALUES('L105','HOWRAH RAILWAY STATION',363648,'PEDDAR ROAD','KOLKATA','WEST BENGAL');
INSERT INTO LOCATION_DETAILS VALUES('L106','LUCKNOW AIRPORT',856473,'HILL ROAD','LUCKNOW','UTTAR PRADESH');
INSERT INTO LOCATION_DETAILS VALUES('L107','GURUGRAM JUNCTION',957467,'CARTER ROAD','GURUGRAM','HARYANA');

INSERT INTO RENTAL_CAR VALUES('DL11SW8464','ALTO',12.09,2014,10000,'ECONOMY','L101');
INSERT INTO RENTAL_CAR VALUES('MH47HD5760','CELERIO',18.22,2015,15000,'ECONOMY','L102');
INSERT INTO RENTAL_CAR VALUES('WB83FF2274','CELERIO',15.34,2014,12356,'ECONOMY','L103');
INSERT INTO RENTAL_CAR VALUES('GJ47NF7364','ALTO',22.34,2016,5000,'ECONOMY','L104');
INSERT INTO RENTAL_CAR VALUES('HR74FH4468','CELERIO',10.90,2015,20145,'ECONOMY','L102');
INSERT INTO RENTAL_CAR VALUES('DL33HF8490','WAGONR',17.90,2014,12000,'COMPACT','L107');
INSERT INTO RENTAL_CAR VALUES('UP42QP0093','DZIRE',21.88,2016,9000,'COMPACT','L106');
INSERT INTO RENTAL_CAR VALUES('PB09SL1123','WAGONR',20.34,2015,15690,'COMPACT','L105');
INSERT INTO RENTAL_CAR VALUES('HP70BN4345','WAGONR',12.92,2014,20900,'COMPACT','L104');
INSERT INTO RENTAL_CAR VALUES('MP12KJ3321','FOCUS',14.67,2016,10009,'COMPACT','L103');
INSERT INTO RENTAL_CAR VALUES('MH72HJ2838','CIAZ',15.58,2016,17800,'MID SIZE','L102');
INSERT INTO RENTAL_CAR VALUES('WB00BD7200','ACCENT',11.76,2012,13420,'MID SIZE','L101');
INSERT INTO RENTAL_CAR VALUES('UK73YU8333','AVENGER',24.89,2015,5000,'MID SIZE','L102');
INSERT INTO RENTAL_CAR VALUES('UP65BB9273','CIAZ',13.45,2016,200,'MID SIZE','L103');
INSERT INTO RENTAL_CAR VALUES('DL16CV1093','AVENGER',18.36,2013,16750,'MID SIZE','L104');
INSERT INTO RENTAL_CAR VALUES('JK83MN3743','SWIFT',19.01,2012,14320,'STANDARD','L105');
INSERT INTO RENTAL_CAR VALUES('BR78NM9009','AMAZE',11.90,2013,15540,'STANDARD','L106');
INSERT INTO RENTAL_CAR VALUES('DL09PL2311','AMAZE',13.32,2014,16300,'STANDARD','L107');
INSERT INTO RENTAL_CAR VALUES('DL32XC7452','SWIFT',12.21,2015,17500,'STANDARD','L101');
INSERT INTO RENTAL_CAR VALUES('PB83VP9838','SWIFT',19.23,2016,18830,'STANDARD','L102');
INSERT INTO RENTAL_CAR VALUES('DL22HJ4874','BALENO',22.22,2012,10900,'FULL SIZE','L103');
INSERT INTO RENTAL_CAR VALUES('UK43ML3732','TIGOR',18.95,2013,11500,'FULL SIZE','L104');
INSERT INTO RENTAL_CAR VALUES('HR66YR3379','TIGOR',10.10,2014,14350,'FULL SIZE','L105');
INSERT INTO RENTAL_CAR VALUES('UP37VC7212','BALENO',19.91,2015,18900,'FULL SIZE','L106');
INSERT INTO RENTAL_CAR VALUES('DL11UY3736','BALENO',9.09,2016,5600,'FULL SIZE','L107');
INSERT INTO RENTAL_CAR VALUES('MH37IO5743','BMW',7.80,2012,18700,'LUXURY CAR','L101');
INSERT INTO RENTAL_CAR VALUES('UP93JK0484','BMW',11.89,2013,17620,'LUXURY CAR','L102');
INSERT INTO RENTAL_CAR VALUES('MP47FI3731','AUDI',13.12,2014,12345,'LUXURY CAR','L103');
INSERT INTO RENTAL_CAR VALUES('DL10PK8311','AUDI',10.58,2015,10800,'LUXURY CAR','L104');
INSERT INTO RENTAL_CAR VALUES('HR38LP9371','BMW',10.77,2016,7800,'LUXURY CAR','L105');
INSERT INTO RENTAL_CAR VALUES('RJ30BF2284','NEXON',21.09,2012,19800,'MID SIZE SUV','L106');
INSERT INTO RENTAL_CAR VALUES('UP11SW7070','KIGER',15.81,2013,17560,'MID SIZE SUV','L107');
INSERT INTO RENTAL_CAR VALUES('DL20IP3821','KIGER',12.67,2014,14390,'MID SIZE SUV','L101');
INSERT INTO RENTAL_CAR VALUES('PB11UY3709','NEXON',23.04,2015,12900,'MID SIZE SUV','L102');
INSERT INTO RENTAL_CAR VALUES('HR88TY2710','NEXON',22.67,2016,3400,'MID SIZE SUV','L103');
INSERT INTO RENTAL_CAR VALUES('UK54OP4511','BREZZA',18.92,2012,27890,'STANDARD SUV','L104');
INSERT INTO RENTAL_CAR VALUES('DL09YA1511','XUV300',13.88,2013,20390,'STANDARD SUV','L105');
INSERT INTO RENTAL_CAR VALUES('BR11HJ0007','XUV300',14.77,2014,18700,'STANDARD SUV','L106');
INSERT INTO RENTAL_CAR VALUES('DL09NV7122','XUV300',12.45,2015,14300,'STANDARD SUV','L107');
INSERT INTO RENTAL_CAR VALUES('PB01VS2222','BREZZA',11.10,2016,5690,'STANDARD SUV','L101');
INSERT INTO RENTAL_CAR VALUES('UP01EP2200','BOLERO',11.58,2012,19870,'FULL SIZE SUV','L102');
INSERT INTO RENTAL_CAR VALUES('DL39UI1101','BOLERO',25.85,2013,14500,'FULL SIZE SUV','L103');
INSERT INTO RENTAL_CAR VALUES('HP30BH1109','SCORPIO',17.11,2014,13290,'FULL SIZE SUV','L104');
INSERT INTO RENTAL_CAR VALUES('GJ67HL0900','SCORPIO',17.45,2015,11750,'FULL SIZE SUV','L105');
INSERT INTO RENTAL_CAR VALUES('DL02KP3011','SCORPIO',16.75,2016,3400,'FULL SIZE SUV','L106');
INSERT INTO RENTAL_CAR VALUES('UP89NB0067','EECO',17.65,2012,23478,'MINI VAN','L107');
INSERT INTO RENTAL_CAR VALUES('PB75CV9000','ESUPRO',11.91,2013,19320,'MINI VAN','L106');
INSERT INTO RENTAL_CAR VALUES('JK11OP2920','EECO',23.21,2014,23478,'MINI VAN','L105');
INSERT INTO RENTAL_CAR VALUES('DL19UI3739','EECO',11.90,2015,13200,'MINI VAN','L104');
INSERT INTO RENTAL_CAR VALUES('DL87BC1100','ESUPRO',15.25,2016,2300,'MINI VAN','L103');

INSERT INTO CAR_INSURANCE VALUES('I201','Covers theft and total damage to the rental car',15);
INSERT INTO CAR_INSURANCE VALUES('I202', 'Covers damage done to others',12);
INSERT INTO CAR_INSURANCE VALUES('I203', 'Covers medical costs for driver and passengers',10);
INSERT INTO CAR_INSURANCE VALUES('I204', 'Covers theft of personal belongings',5);



INSERT INTO BOOKING_DETAILS VALUES('B1001','2021-01-20 10:00:00','2021-01-25 10:00:00',
150,'R','L101','L105','DL11SW8464','DL20125990',NULL);
INSERT INTO BOOKING_DETAILS VALUES('B1002','2021-01-21 11:00:00','2021-01-24 10:00:00',
90,'C','L102','L106','MH47HD5760','HR20135949',NULL);
INSERT INTO BOOKING_DETAILS VALUES('B1003','2021-02-10 13:00:00','2021-01-15 13:00:00',
450,'R','L101','L103','MH37IO5743','UP20155780','I201');
INSERT INTO BOOKING_DETAILS VALUES('B1004','2021-04-24 13:00:00','2021-04-25 20:30:00',
48,'R','L106','L106','RJ30BF2284','UP20024564','I202');
INSERT INTO BOOKING_DETAILS VALUES('B1005','2021-04-18 09:00:00','2021-04-25 09:00:00',
266,'B','L102','L106','PB83VP9838','PB20123748',NULL);
INSERT INTO BOOKING_DETAILS VALUES('B1006','2021-04-21 17:00:00','2021-04-25 17:00:00',
168,'B','L105','L107','PB09SL1123','HR20047468','I203');
INSERT INTO BOOKING_DETAILS VALUES('B1007','2021-04-16 08:00:00','2021-04-25 17:00:00',
405,'B','L102','L104','MH47HD5760','MH20034758','I201');
INSERT INTO BOOKING_DETAILS VALUES('B1008','2021-04-11 08:00:00','2021-04-25 17:00:00',
630,'B','L102','L101','HR74FH4468','HR20135949','I201');

INSERT INTO FINAL_BILL VALUES('BL1001','2021-01-25',
'PAID',1380.03,130.38 ,'B1001',32);
INSERT INTO FINAL_BILL VALUES('BL1002','2021-01-15',
'PAID',4870.13 ,245.38 ,'B1003',0);
INSERT INTO FINAL_BILL VALUES('BL1003','2016-04-24',
'PAID',4123.57 ,210.96 ,'B1004',0);

Select * from CUSTOMER;
SELECT * FROM CAR_DETAILS;
SELECT * FROM LOCATION_DETAILS;
SELECT * FROM RENTAL_CAR;
SELECT * FROM CAR_INSURANCE;
SELECT * FROM BOOKING_DETAILS;
SELECT * FROM FINAL_BILL;

SELECT * FROM RENTAL_CAR, LOCATION_DETAILS WHERE Location_ID=L_ID AND State = 'DELHI';

SELECT * FROM BOOKING_DETAILS, LOCATION_DETAILS WHERE Drop_off_Loc_id=Location_ID AND Location_Name = 'PALLAM AIRPORT';

SELECT * FROM BOOKING_DETAILS WHERE NOT EXISTS (SELECT * FROM FINAL_BILL WHERE Booking_ID=B_ID);

SELECT * FROM BOOKING_DETAILS, CAR_INSURANCE WHERE Insurance_ID=Ins_ID AND Insurance_Type = 'Covers damage done to others';

SELECT Fuel_Type, COUNT(Registration_NO) AS Number_of_Cars FROM CAR_DETAILS, RENTAL_CAR WHERE Car_Type = Car_Category GROUP BY(Fuel_Type);

SELECT * FROM CUSTOMER, RENTAL_CAR, BOOKING_DETAILS WHERE DL_Number=DL_Num AND Registration_NO = Reg_NO AND (Model_Name = 'ALTO' OR Model_Name = 'EECO');

SELECT * FROM CUSTOMER, BOOKING_DETAILS WHERE DL_Number=DL_Num AND State = 'MAHARASHTRA';

